<div class="w-full p-4 bg-[#201a23]">
  <!-- Mobile toggle button (left-aligned) -->
  <div class="flex justify-start md:hidden">
    <button class="bg-[#4e444b] px-4 py-2 flex items-center" (click)="showFilters = !showFilters">
      <mat-icon>filter_list</mat-icon>
      <span>Filters</span>
    </button>
  </div>

  <!-- Filter row -->
  <div class="flex flex-col md:flex-row flex-wrap md:gap-4 p-2 sm:w-full" [class.hidden]="!showFilters && isMobile">
    <!-- Type -->
    <mat-form-field class="sm:w-[10%]" appearance="fill">
      <mat-label>Type</mat-label>
      <mat-select [(ngModel)]="selectedTypeSignal" (selectionChange)="updateFilter()">
        @for (type of ['movies', 'series']; track type) {
          <mat-option [value]="type">{{ type | titlecase }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Category -->
    <mat-form-field class="sm:w-[12%]" appearance="fill">
      <mat-label>Category</mat-label>
      <mat-select [(ngModel)]="selectedCategory" (selectionChange)="updateFilter()">
        @for (category of ['Popular', 'New', 'Top Rated', 'Now Playing']; track category) {
          <mat-option [value]="category">{{ category }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Year -->
    <mat-form-field class="sm:w-[8%]" appearance="fill">
      <mat-label>Year</mat-label>
      <mat-select [(ngModel)]="selectedYear" (selectionChange)="updateFilter()">
        <mat-option><mat-icon>replay</mat-icon></mat-option>
        @for (year of years; track year) {
          <mat-option [value]="year">{{ year }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Genres -->
    <mat-form-field class="sm:w-[15%]" appearance="fill">
      <mat-label>Genres</mat-label>
      <mat-select [multiple]="true" [(ngModel)]="selectedGenres" (selectionChange)="onGenreChange($event)">
        <mat-option class="no-checkbox"><mat-icon>replay</mat-icon></mat-option>
        @for (genre of genres; track genre) {
          <mat-option [value]="genre.id">{{ genre.name }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Studios/Networks -->
    <mat-form-field class="sm:w-[18%]" appearance="fill">
      <mat-label>{{ selectedTypeSignal() === 'movies' ? 'Studios' : 'Networks' }}</mat-label>
      <mat-select [(ngModel)]="selectedStudiosOrNetworks" (selectionChange)="updateFilter()">
        <mat-option><mat-icon>replay</mat-icon></mat-option>
        @for (studioNetwork of studiosOrNetworks; track studioNetwork) {
          <mat-option [value]="studioNetwork.id">{{ studioNetwork.name }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Keyword Input -->
    <div class="sm:w-[20%]">
      <mat-form-field class="w-full">
        <mat-label>Keywords</mat-label>
        <input
          matInput
          (input)="onKeywordInput($any($event.target).value)"
          [(ngModel)]="keywordInput"
          placeholder="Search keywords"
        />
      </mat-form-field>

      <!-- Keyword suggestions dropdown -->
      @if (keywordResults().length > 0) {
        <ul class="absolute bg-[#231e22] z-50 w-full max-h-56 overflow-y-auto rounded-md mt-2">
          @for (keyword of keywordResults(); track keyword.id) {
            <li
              (click)="addKeywordFromSuggestion(keyword)"
              class="p-2 text-white hover:bg-gray-700 cursor-pointer"
            >
              {{ keyword.name }}
            </li>
          }
        </ul>
      }
    </div>
  </div>

  <!-- Selected Keywords Row -->
  <div class="flex gap-2 justify-end w-full sm:w-[90%]">
    @for (keyword of selectedKeywords(); track keyword.id) {
      <mat-chip
        [removable]="true"
        (removed)="removeKeyword(keyword.id)"
        class="bg-gray-700 text-white"
      >
        {{ keyword.name }}
        <mat-icon matChipRemove>cancel</mat-icon>
      </mat-chip>
    }
  </div>
</div>
